<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/mypage.css">
    <title>회원정보</title>
    <style>

        .profile-details {
            display: flex;
            flex-direction: column;
            align-items: center; 
            gap: 10px;
            margin: 0 auto;
        }

        .form-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group label {
            width: 110px;
            text-align: left;
        }

        .form-group input {
            padding: 10px;
            border: 1px solid #ddd;
            font-size: 15px;
        }

        .form-group input[type="text"].tel {
            width: 162px; 
        }

        .form-group input:not(.tel) {
            width: 540px; 
        }

        /* 수정 불가능한 필드 스타일 */
        .form-group input[readonly]:not(.editable) {
            background-color: #f0eeee;
        }

        /* 비밀번호 확인 필드 (초기 숨김) */
        .password-check {
            display: none;
        }

        /* 버튼 */
        .btn {
            border: 1px solid #ccc;
            padding: 10px 20px;
            margin : 20px 10px -10px 0;
            cursor: pointer;
            font-size: 15px;
            font-weight: 400;
        }

        .upBtn{
            background : #1a1a1a;
            color : #FAFAFA;
        }

        .pwBtn{
            background : #FFF;
            color : #1a1a1a;
        }

        .form-group div {
            display: flex;
            justify-content: flex-start;
            margin-top: 10px;
        }

    </style>

    <script>
    fetch('header.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('header-container').innerHTML = data;
        });

    fetch('footer.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('footer-container').innerHTML = data;
        });
    </script>
</head>
<body>
    
    <div id="header-container">
        
    </div>
    <div id = "blank">

    </div>
    <div class="container">
        <div class="header">
            <div class = "title">마이페이지</div>
        </div>
        <ul class="menu">
            <li  class = "selected">
            <a href = "mypage_member.html">회원정보</a>
            </li>
            <li>
                <a href = "mypage_club.html">가입 동아리</a>
            </li>
            <li>
                <a href = "mypage_community.html">게시글 관리</a>
            </li>
            <li>
                <a href = "mypage_shop.html">주문내역</a>                
            </li>
            <li>
                <a href = "mypage_point.html">적립금</a>                
            </li>
        </ul>
        
        <div class="content">
            <div class="profile-details">
                <div class="form-group">
                    <label>아이디</label>
                    <input type="text" value="aaa" readonly>
                </div>
                <div class="form-group">
                    <label>이름</label>
                    <input type="text" value="홍길동" readonly>
                </div>
                <div class="form-group">
                    <label>닉네임</label>
                    <input type="text" class="editable" value="길동스" readonly>
                </div>
                <div class="form-group">
                    <label>전화번호</label>
                    <input type="text" class="tel editable" value="010" readonly>
                    <a>-</a>
                    <input type="text" class="tel editable" value="1234" readonly>
                    <a>-</a>
                    <input type="text" class="tel editable" value="5678" readonly>
                </div>
                <div class="form-group">
                    <label>이메일</label>
                    <input type="email" value="hong@example.com" readonly>
                </div>
                <div class="form-group">
                    <label>가입일</label>
                    <input type="text" value="2024-01-15" readonly>
                </div>
                <div class="form-group password-check" id="passwordCheck">
                    <label>비밀번호 확인</label>
                    <input type="password" id="passwordInput" placeholder="비밀번호를 입력하세요">
                </div>
                <div class="form-group">
                    <label></label>
                    <div>
                        <button class="btn upBtn" id="editBtn">정보 수정</button>
                        <button class="btn pwBtn" onclick="openPopup()">비밀번호 변경</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
            
    </div>

    <div class = "blank" style = "height : 100px;">

    </div>
    <div id="footer-container">
        
    </div>
    <script>

        function openPopup(){
            window.open(
                "mypw.html",   // 열 페이지 (같은 폴더에 popup.html 있다고 가정)
                "pwupdate",  // 창 이름
                "width=550,height=650,top=100,left=200,resizable=no,scrollbars=yes"
            );
        }


        // 메뉴 클릭 처리
        document.addEventListener('DOMContentLoaded', function() {
            const menuItems = document.querySelectorAll('.menu li');
            
            menuItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    // 모든 메뉴에서 selected 클래스 제거
                    menuItems.forEach(menu => {
                        menu.classList.remove('selected');
                    });
                    
                    // 클릭된 메뉴에 selected 클래스 추가
                    this.classList.add('selected');
                });
            });
        });

        // 정보 수정 기능
        document.addEventListener('DOMContentLoaded', function() {
            const editButton = document.getElementById('editBtn');
            const passwordCheckDiv = document.getElementById('passwordCheck');
            const passwordInput = document.getElementById('passwordInput');
            const correctPassword = '1234'; // 실제로는 서버에서 확인해야 함
            
            editButton.addEventListener('click', function() {
                const editableInputs = document.querySelectorAll('.editable');
                
                if (this.textContent === '정보 수정') {
                    // 비밀번호 확인 필드 표시
                    passwordCheckDiv.style.display = 'flex';
                    this.textContent = '확인';
                    passwordInput.focus();
                    
                } else if (this.textContent === '확인') {
                    // 비밀번호 확인
                    if (passwordInput.value === correctPassword) {
                        // 비밀번호가 맞으면 편집 가능하게 변경
                        editableInputs.forEach(input => {
                            input.removeAttribute('readonly');
                            input.style.backgroundColor = '#fff';
                            input.style.color = "#1a1a1a";
                        });
                        
                        passwordCheckDiv.style.display = 'none';
                        passwordInput.value = '';
                        this.textContent = '저장';
                        
                    } else {
                        alert('비밀번호가 일치하지 않습니다.');
                        passwordInput.value = '';
                        passwordInput.focus();
                    }
                    
                } else {
                    // 저장
                    editableInputs.forEach(input => {
                        input.setAttribute('readonly', true);
                        input.style.backgroundColor = '#f0eeee';
                        input.style.color = "#666";
                    });
                    this.textContent = '정보 수정';
                    alert('정보가 수정되었습니다.');
                }
            });
            
            // 초기 스타일 설정 - 수정 불가능한 필드들 배경색 설정
            const readonlyInputs = document.querySelectorAll('input[readonly]:not(.editable)');
            readonlyInputs.forEach(input => {
                input.style.backgroundColor = '#f0eeee';
                input.style.color = "#666";
            });
            
            // 수정 가능한 필드들도 초기에는 회색 배경
            const editableInputs = document.querySelectorAll('.editable');
            editableInputs.forEach(input => {
                input.style.backgroundColor = '#f0eeee';
                input.style.color = "#666";
            });
        });
    </script>
</body>
</html>